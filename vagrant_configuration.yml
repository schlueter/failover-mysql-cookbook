BOX: ubuntu/trusty64

DATABASE_SERVER: &database_server mysql

FAILOVER_FILE_PREFIX: |
  This file is generated by the Vagrantfile in this directory.
  It states the current sql master on a line starting with 'master='.
  If that line or this file does not exist, the Vagrantfile will
  assume the 'sql1' box is the master. Any other line is ignored.

VMS:
  sql1:
    memory: &sql1_memory 2048
    cpus: &sql1_cpus 2
  sql2:
    memory: &sql2_memory 2048
    cpus: &sql2_cpus 2
  web:
    memory: &web_memory 2048
    cpus: &web_cpus 2


IP_ADDRESSES:
  sql1: &sql1_ip 192.168.10.11
  sql2: &sql2_ip 192.168.10.12
  web: &web_ip 192.168.10.13

PASSWORDS:
  - &sql1_root_pass root1pass
  - &sql2_root_pass root2pass

CHEF_JSON:
  sql1:
    failover-mysql:
      database:
        host: *sql1_ip
        root_password: *sql1_root_pass
        server: *database_server
        server_id: 1
        slave_host: *sql2_ip
      web:
        host: *web_ip

  sql2:
    failover-mysql:
      database:
        host: *sql2_ip
        master_host: *sql1_ip
        root_password: *sql2_root_pass
        server: *database_server
        server_id: 2
        slave_host: *sql1_ip
      web:
        host: *web_ip

  sql1_failover:
    failover-mysql:
      database:
        failover: true
        host: *sql1_ip
        master_host: *sql1_ip
        root_password: *sql1_root_pass
        server: *database_server
        slaves:
          - host: *sql2_ip
            username: root
            password: *sql2_root_pass

  sql2_failover:
    failover-mysql:
      database:
        failover: true
        host: *sql2_ip
        master_host: *sql2_ip
        root_password: *sql2_root_pass
        server: *database_server
        slaves:
          - host: *sql1_ip
            username: root
            password: *sql1_root_pass

  web:
    failover-mysql:
      database:
        host: *sql1_ip
        root_password: *sql1_root_pass
    wordpress:
      server_aliases:
        - *web_ip
        - 127.0.0.1
        - localhost
      wp_config_options:
        DISABLE_WP_CRON: !!str true

  web_failover:
    failover-mysql:
      database:
        host: *sql2_ip
        root_password: *sql2_root_pass
    wordpress:
      server_aliases:
        - *web_ip
        - 127.0.0.1
        - localhost
